<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Order</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>

    <div class="container-fluid p-0">

        <!-- header -->
        <nav class="navbar container">
            <div>
                <h4>Logo</h4>
            </div>
            
            <h4>Food Order</h4>
            
            <div>
                <a href="./cart.html" class="text-success">
                    CART
                </a>
            </div>
        </nav>
        <!-- header -->

        <!-- content card -->
        <div class="container p-0 d-flex flex-wrap" id="row-card">
 
            <!-- Food Card -->

            <!-- Food Card -->
            
        </div>
        <!-- content card -->
    </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" 
integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    $(document).ready(function(){
        const API_URL = 'https://meal-db-sandy.vercel.app/meals'
        const API_KEY = '6743321d-0ab0-4197-a45c-0d432c511c87'
        const defaulPrice = 5.00;

        $.ajax({
            url:API_URL,
            type: "GET",
            headers:{
                "X-DB-NAME": API_KEY
            },
            success:function(res){
                $('#row-card').empty();
                console.log(res);
                
                let html = '';

                res.forEach(item => {
                    html += `
                        <div class="col-lg-3 p-2">
                            <div class="card overflow-hidden">
                                <!-- for food img -->
                                <img src="${item.mealThumb}" alt="" width="100%" height="250px" class="object-fit-cover">

                                <!-- card body -->
                                <div class="card-body">

                                    <!-- food name -->
                                    <h5 class="text-limit-one">${item.meal}</h5>

                                    <!-- food description -->
                                    <span class="text-limit text-secondary" style="font-size: 14px;">
                                      ${item.instructions}
                                    </span>

                                    <!-- food price and button add to cart -->
                                    <div class="d-flex justify-content-between align-items-center py-2 border-top mt-3">
                                        <p class="mb-0 text-danger fw-bold">$${defaulPrice.toFixed(2)}</p>

                                        <button 
                                            id="btn-add-to-cart"
                                            class="btn btn-success py-1 rounded-pill px-3"
                                            data-id="${item.id}"
                                            data-meal="${item.meal}"
                                            data-meal-thumb="${item.mealThumb}"
                                            data-price="${defaulPrice.toFixed(2)}"
                                        >
                                            Add To Cart +
                                        </button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    `;
                })

                $('#row-card').html(html)
            },
            error:function(err){
                console.log(err)
            }
        });

        $(document).on('click', '#btn-add-to-cart', function(){

            const item = { 
                id: $(this).data('id'),
                name: $(this).data('meal'),
                thumb: $(this).data('meal-thumb'),
                price: $(this).data('price'),
                quantity: 1
            }

        
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            // [{item}]
            cart.push(item);

            localStorage.setItem('cart', JSON.stringify(cart));
            //                    key     value
            //                    cart   [{"id":1,"name":"Fried Rice",...}]
            alert('Item added to cart!')
        })
    })
</script>
</html>
